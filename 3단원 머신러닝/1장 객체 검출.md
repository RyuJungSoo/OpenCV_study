# 머신러닝이란?
**머신러닝** 은 기계, 즉 컴퓨터에 사물을 인지 및 판단할 수 있도록 학습시키는 것이며, 영상에서 원하는 대상을 검지하거나 분류시키는 것이 머신러닝의 대표적인 목적 중 하나이다.         
개념적으로 기계를 학습시킨다는 것은 머퓨터에게 특정 문제에 대한 샘플들을 제공한 후에 이를 해결하기 위한 기준 또는 근거를 조정하도록 하는 것이다.        
여기서 기준 또는 근거는 설계자에 의해 주어질 수 있다.           
***

# 1.1. 템플릿 매칭
**탬플릿 매칭** 은 전체 이미지에서 관심 있는 특정한 이미지 영역을 **검색** 하기 위한 매우 단순한 기술이다. 일반적으로는 관심 영역 또는 대상을 나타내기 위하여 
이미지 샘플을 이용하며, 이는 매우 단순하면서도 효율적이다.              
아래 그림과 같이 템플릿 매칭을 통하여 원하는 객체를 찾는데 사용될 수 있다.           
***
<입력 영상>        
<img src="https://user-images.githubusercontent.com/81175672/182107016-70a31723-356a-4eda-a5e2-f4ebebf894c4.JPG"  width="500" height="400"/>                  
<입력 영상에서 선택한 관심 영역>                 
<img src="https://user-images.githubusercontent.com/81175672/182107679-b7d79658-2bbe-4e94-b085-be9c059b2a62.JPG"  width="300" height="300"/>                  
<템플릿 매칭에 의해 찾아진 결과>                 
<img src="https://user-images.githubusercontent.com/81175672/182107753-00ad4bfd-da9e-405d-954b-4df12ec726de.JPG"  width="500" height="400"/>               
***
탬플릿 매칭은 대표적으로 반도체 제품의 패턴 검사와 장비 검사에 쓰이고 있다. 또한, 객체 검지 및 추적과 원하는 형상을 찾기 위해서도 사용된다.           
**템플릿 매칭** 은 주어진 입력 이미지에 탬플릿을 **슬라이딩 윈도우 방식** 으로 적용하여 유사함을 평가하는 과정이다.           
_슬라이딩 윈도우 기법은 주어진 탬플릿을 입력 이미지에 겹치게 하여 일정 간격으로 템플릿을 이동시키면서 유사함을 계산해 가는 방식이다._      
***
유사도를 평가하는 방식은 다음과 같다.            
## 제곱 차이 매칭 방법
<img src="https://user-images.githubusercontent.com/81175672/182122143-7375030d-d171-4ce6-bac5-cc9df8f20f8e.JPG"  width="900" height="300"/>                

**제곱 차이 매칭 방법** 은 위의 식과 같다. **T**와 **I**는 각각 템플릿과 입력 이미지를 의미하고, **i'** 과 **j'** 은 템플릿 상의 픽셀 위치, **i** 와 **j** 는 입력 이미지상의 
픽셀 위치이다.               
즉, 템플릿의 값과 이에 매칭되는 입력 이미지상의 값의 차이를 제곱하여 모두 합한 값을 결과로 반환한다. 따라서 **완벽하게 일치** 하는 경우에는 0의 결과를 가지고, 
**템플릿과 상이할수록** 큰 값을 가진다.             

## 정규화된 제곱 차이 매칭 방법
<img src="https://user-images.githubusercontent.com/81175672/182122259-8c69f4f7-5627-45f9-a3a7-8a8b73fa002f.JPG"  width="900" height="300"/>              

**정규화된 제곱 차이 매칭** 은 제곱 차이 매칭의 값을 정규화하여 표현한 것으로 위의 식과 같다. 템플릿과 **완벽하게 일치**하는 경우에 0의 값을 가진다.

## 상관관계 매칭 방법
<img src="https://user-images.githubusercontent.com/81175672/182122253-60b0faa3-99b4-43db-99ee-543d1906ff6a.JPG"  width="900" height="300"/>           

**상관관계 매칭 방법** 은 템플릿과 이에 매칭되는 입력 이미지상의 값을 곱하여 모두 합한 값을 결과로 반환한다. 따라서 **매칭이 잘 될수록** 큰 값을 가지고, 
**반대의 경우**에는 작은 값이나 0의 값을 가질 수도 있다.

## 정규화된 상관관계 매칭 방법 
<img src="https://user-images.githubusercontent.com/81175672/182122248-2bb2df32-c156-4cbe-8822-1dcb2d0a28eb.JPG"  width="900" height="300"/>          

**정규화된 상관관계 매칭 방법** 은 상관관계 매칭의 값을 정규화하여 표현한 것으로 아래 식과 같다. 템플릿과 **불일치** 할수록 0에 가까운 값을 가진다.         
위의 매칭 방법들은 입력 이미지와 템플릿의 값을 그대로 사용한다. 따라서 _조명 등의 영향으로 상이한 환경_ 에서 획득한 입력 이미지 또는 템플릿을 사용할 경우에는 
유의미한 매칭 영역을 찾는 것이 용이하지 않을 수도 있다.                 
-> 이를 보완한 방법: **상관계수 매칭 방법, 정규화된 상관계수 매칭 방법**               
***
<img src="https://user-images.githubusercontent.com/81175672/182132970-e71bfe61-9ae0-4be2-bca2-53746bdb2f49.JPG"  width="1000" height="600"/>          
**상관계수 매칭 방법, 정규화된 매칭 방법**은 위 수식과 같으며, 입력 이미지와 템플릿을 각각의 이미지 값의 평균을 반영하여 매칭하므로 외부 환경에 강인한 결과를 반환한다.     
템플릿 매칭은 계산량이 많은 작업이므로, 효율적으로 사용하는 것이 중요하다.        

