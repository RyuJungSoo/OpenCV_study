# 5.1 이동 및 크기 변환
## 어파인 변환
영상의 **기하학적 변환(Geometric Transformation)** 은 영상을 구성하는 픽셀의 위치를 조정하여 형상을 변형하는 것이다. 대표적으로 **이동, 확대 및 축소, 회전** 등이 있다. 
이들은 입력과 출력 간의 좌표 변환을 기반으로 수행되며 이러한 연산을 일반적으로 **어파인 변환**이라고 한다.           
좌표 변환은 기본적으로 입력 좌표에 특정 변환함수를 적용하여 새로운 좌표를 생성하는 과정으로 아래 식으로 표현할 수 있다.             
<img src="https://user-images.githubusercontent.com/81175672/179739345-0e51b15e-6386-46a2-8271-c3a943533813.JPG"  width="700" height="200"/>              
***
변환함수 *T*에 따라서 기하학적 변환 특징이 정해지며, 2D 영상에서 어파인 변환은 아래와 같이 입력과 출력의 관계를 정의한다.                
<img src="https://user-images.githubusercontent.com/81175672/179739714-b99a7dea-5d55-430c-bdb6-67f99dc7ccfe.JPG"  width="700" height="200"/>              
해당 축에 곱해지는 상수(a와 e)만 있을 경우에는 **크기 변환** 이 수행되고, 더해지는 상수(c와 f)는 **이동 변환**을 수행한다.                 
그리고 각각의 축에 상수곱을 하고 합하는 경우(a와 b, d와 e)는 **회전 변환**을 수행할 수 있다.              
a~f로 이루어진 변환을 결정하는 행렬을 **어파인 변환 행렬** 이라고 한다.        
***
## 이동 변환                      
**이동 변환** - 영상을 수평 또는 수직 방향으로 이동시키는 연산                
<img src="https://user-images.githubusercontent.com/81175672/179748812-7192a280-4c7b-45e4-afda-9660137baebe.JPG"  width="700" height="200"/>           
f = 0, c > 0 -> 영상이 오른쪽으로 이동     
f = 0, c < 0 -> 영상이 왼쪽으로 이동             
f > 0, c = 0 -> 영상이 아래로 이동             
f < 0, c = 0 -> 영상이 위로 이동            
각 상수의 부호와 크기에 따라서 영상의 이동이 결정된다.                  
<img src="https://user-images.githubusercontent.com/81175672/179754404-7a8aaeb7-5358-4b00-a95f-005e521e586e.png"  width="800" height="400"/>                      
(출처: https://velog.io/@codren/%EC%98%81%EC%83%81-%ED%8C%8C%EC%9D%BC%EC%9D%98-%EA%B8%B0%ED%95%98%ED%95%99%EC%A0%81-%EB%B3%80%ED%99%98)                  
***
## 크기 변환         
**크기 변환** - 영상을 전반적으로 확대 또는 축소하는 연산                      
<img src="https://user-images.githubusercontent.com/81175672/179752403-17baff2f-9666-47a2-b0dc-3f6c4ebdb685.JPG"  width="700" height="200"/>               
a와 e가 0 이상의 값을 가져야 한다. 만약 0으로 한다면, 영상이 한 점으로 표시되고 아무런 정보를 얻을 수 없다. 
0 < (a, e) < 1 -> 영상이 축소                 
(a, e) = 1 -> 입력 영상의 크기를 유지               
(a, e) > 1 -> 영상이 확대            
<img src="https://user-images.githubusercontent.com/81175672/179754719-0590eec2-af45-43cb-81a9-26148a47cd2b.png"  width="800" height="400"/>           
(출처: https://velog.io/@codren/%EC%98%81%EC%83%81-%ED%8C%8C%EC%9D%BC%EC%9D%98-%EA%B8%B0%ED%95%98%ED%95%99%EC%A0%81-%EB%B3%80%ED%99%98)                      
***
## 어파인 변환 함수
OpenCV에서는 어파인 변환을 수행하는 **warpAffine() 함수**를 지원한다. 어파인 변환 행렬은 사용자가 임의로 지정할 수도 있고, **getAffineTransform() 함수** 를 이용하여 
계산할 수도 있다.           
***
**getAffineTransform(src, dst)**
기능: 3개의 입력점(src)을 출력점(dst)으로 변환하기 위한 어파인 변환 행렬을 계산한다.            
| 매개변수 | 의미 |
| --- | --- |
| src | 변환 전 3개의 점 위치 (float32) |
| dst | 변환 후 3개의 점 위치 (float32) |
***
**warpAffine(src, M, dsize, dst=None, flags=None, borderMode=None, borderValue=None)**
기능: 입력 영상(src)을 주어진 변환 행렬(M)을 지용하여 어파인 변호나하고 지정된 크기(dsize)의 영상으로 만든다.        
| 매개변수 | 의미 |
| --- | --- |
| src | 입력 영상 |
| M | 변환 행렬 (2x3 행렬) |
| dsize | 출력 영상의 크기 |
| dst | 출력 영상 |
| flags | 보간법 방식 지정(INTER_NEAREST, INTER_LINEAR, INTER_CUBIC, INTER_AREA 등이 있음. WARP_INVERSE_MAP을 추가 지정하면 역방향 변환을 수행함(dst -> src)) |
| borderMode | 영상의 가장 자리를 처리하는 방식 지정(BORDER_TRANSPARENT)이면, 입력 영상에 대응하는 점이 없을 경우에는 출력 영상의 값을 유지 |
| borderValue | borderMode가 BORDER_CONSTANT인 경우에 해당 픽셀을 채울 값 (기본값은 0) |           
***
또한, OpenCV에서는 크기 변환을 위한 **resize() 함수** 를 제공하며, 원형은 다음과 같다. 크기 변환만을 할 경우에는 이 함수를 이용하는 것이 편리하다.         

***
